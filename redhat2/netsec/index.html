
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://divijesh.tech/redhat2/netsec/">
      
      <link rel="icon" href="../../assets/img/layout/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Managing Network Security - Divijesh Varma</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="teal">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#managing-server-firewalls" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Divijesh Varma" class="md-header__button md-logo" aria-label="Divijesh Varma" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Divijesh Varma
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Managing Network Security
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../linux/vi/" class="md-tabs__link">
        Linux
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../redhat/intro/" class="md-tabs__link md-tabs__link--active">
        RedHat
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../english/vol1/" class="md-tabs__link">
        English
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../basics/threat-modeling/" class="md-tabs__link">
        Knowledge Base
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tools/" class="md-tabs__link">
        Recommendations
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Divijesh Varma" class="md-nav__button md-logo" aria-label="Divijesh Varma" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Divijesh Varma
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Editors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Editors" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Editors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/vi/" class="md-nav__link">
        Vim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/nano/" class="md-nav__link">
        Nano
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Notes" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/rhcsa/" class="md-nav__link">
        Tritree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/user/" class="md-nav__link">
        User Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/acl/" class="md-nav__link">
        Access control lists (ACLs)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/network/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/ssh/" class="md-nav__link">
        OpenSSH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/process/" class="md-nav__link">
        Process Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/software/" class="md-nav__link">
        Software Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/systemd/" class="md-nav__link">
        Systemd Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cron/" class="md-nav__link">
        Cron Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/logs/" class="md-nav__link">
        Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/disk/" class="md-nav__link">
        Disk Management
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          RedHat
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RedHat" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          RedHat
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          RHSA I (RH124)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RHSA I (RH124)" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          RHSA I (RH124)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/access/" class="md-nav__link">
        Accessing The Command Line
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/manage/" class="md-nav__link">
        Managing Files From The Command Line
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/help/" class="md-nav__link">
        Getting Help In Red Hat Enterprise Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/edit/" class="md-nav__link">
        Creating, Viewing, And Editing Text Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/users/" class="md-nav__link">
        Managing Local Users And Groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/control/" class="md-nav__link">
        Controlling Access To Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/monitor/" class="md-nav__link">
        Monitoring And Managing Linux Processes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/service/" class="md-nav__link">
        Controlling Services And Daemons
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/secssh/" class="md-nav__link">
        Configuring And Securing Ssh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/store/" class="md-nav__link">
        Analyzing And Storing Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/mannet/" class="md-nav__link">
        Managing Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/archiv/" class="md-nav__link">
        Archiving And Transferring Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/pack/" class="md-nav__link">
        Installing And Updating Software Packages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/filsys/" class="md-nav__link">
        Accessing Linux File Systems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/support/" class="md-nav__link">
        Analyzing Servers And Getting Support
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redhat/review/" class="md-nav__link">
        Comprehensive Review
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          RHSA II (RH134)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RHSA II (RH134)" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          RHSA II (RH134)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cmd/" class="md-nav__link">
        Improving Command-Line Productivity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/" class="md-nav__link">
        Scheduling Future Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        Tuning System Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../acls/" class="md-nav__link">
        Controlling Access To Files With Acls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../selinux/" class="md-nav__link">
        Managing Selinux Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        Managing Basic Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lvm/" class="md-nav__link">
        Managing Logical Volumes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vdo/" class="md-nav__link">
        Implementing Advanced Storage Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nas/" class="md-nav__link">
        Accessing Network-Attached Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../boot/" class="md-nav__link">
        Controlling The Boot Process
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Managing Network Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Managing Network Security
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#managing-server-firewalls" class="md-nav__link">
    MANAGING SERVER FIREWALLS
  </a>
  
    <nav class="md-nav" aria-label="MANAGING SERVER FIREWALLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#firewall-architecture-concepts" class="md-nav__link">
    FIREWALL ARCHITECTURE CONCEPTS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-firewall" class="md-nav__link">
    CONFIGURING THE FIREWALL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controlling-selinux-port-labeling" class="md-nav__link">
    CONTROLLING SELINUX PORT LABELING
  </a>
  
    <nav class="md-nav" aria-label="CONTROLLING SELINUX PORT LABELING">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selinux-port-labeling" class="md-nav__link">
    SELINUX PORT LABELING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-selinux-port-labeling" class="md-nav__link">
    MANAGING SELINUX PORT LABELING
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    SUMMARY
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab" class="md-nav__link">
    LAB
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instalrhel/" class="md-nav__link">
        Installing Red Hat Enterprise Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Creview/" class="md-nav__link">
        Comprehensive Review
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          English
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="English" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          English
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../english/vol1/" class="md-nav__link">
        Vol-1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../english/vol2/" class="md-nav__link">
        Vol-2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../english/vol3/" class="md-nav__link">
        Vol-3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../english/vol4/" class="md-nav__link">
        Vol-4
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Knowledge Base
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Knowledge Base" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Knowledge Base
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          The Basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="The Basics" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          The Basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/threat-modeling/" class="md-nav__link">
        Threat Modeling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/dns/" class="md-nav__link">
        Introduction to DNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/multi-factor-authentication/" class="md-nav__link">
        Multi-factor Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/account-deletion/" class="md-nav__link">
        Account Deletion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Android
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Android" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Android
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/overview/" class="md-nav__link">
        Android Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/grapheneos-vs-calyxos/" class="md-nav__link">
        GrapheneOS vs CalyxOS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linux" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux-desktop/overview/" class="md-nav__link">
        Linux Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux-desktop/hardening/" class="md-nav__link">
        System Hardening
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux-desktop/sandboxing/" class="md-nav__link">
        Application Sandboxing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_4">
          Advanced
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/integrating-metadata-removal/" class="md-nav__link">
        Integrating Metadata Removal
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Recommendations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Recommendations" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Recommendations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/" class="md-nav__link">
        Privacy Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Browsers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Browsers" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Browsers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../browsers/" class="md-nav__link">
        Web Browsers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Operating Systems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Operating Systems" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Operating Systems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/" class="md-nav__link">
        Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux-desktop/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qubes/" class="md-nav__link">
        Qubes OS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../router/" class="md-nav__link">
        Router Firmware
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Providers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Providers" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Providers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/" class="md-nav__link">
        Cloud Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dns/" class="md-nav__link">
        DNS Resolvers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../email/" class="md-nav__link">
        Email Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../search-engines/" class="md-nav__link">
        Search Engines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vpn/" class="md-nav__link">
        VPN Services
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_5" type="checkbox" id="__nav_6_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_5">
          Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Software" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../calendar-contacts/" class="md-nav__link">
        Calendar and Contact Sync
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/" class="md-nav__link">
        Notebooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../email-clients/" class="md-nav__link">
        Email Clients
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../encryption/" class="md-nav__link">
        Encryption Software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../file-sharing/" class="md-nav__link">
        File Sharing and Sync
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metadata-removal-tools/" class="md-nav__link">
        Metadata Removal Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../multi-factor-authentication/" class="md-nav__link">
        Multi-Factor Authenticators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../passwords/" class="md-nav__link">
        Password Managers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../productivity/" class="md-nav__link">
        Productivity Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../real-time-communication/" class="md-nav__link">
        Real-Time Communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../news-aggregators/" class="md-nav__link">
        News Aggregators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../self-contained-networks/" class="md-nav__link">
        Self-Contained Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../video-streaming/" class="md-nav__link">
        Video Streaming
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        Heading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#managing-server-firewalls" class="md-nav__link">
    MANAGING SERVER FIREWALLS
  </a>
  
    <nav class="md-nav" aria-label="MANAGING SERVER FIREWALLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#firewall-architecture-concepts" class="md-nav__link">
    FIREWALL ARCHITECTURE CONCEPTS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-firewall" class="md-nav__link">
    CONFIGURING THE FIREWALL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controlling-selinux-port-labeling" class="md-nav__link">
    CONTROLLING SELINUX PORT LABELING
  </a>
  
    <nav class="md-nav" aria-label="CONTROLLING SELINUX PORT LABELING">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selinux-port-labeling" class="md-nav__link">
    SELINUX PORT LABELING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-selinux-port-labeling" class="md-nav__link">
    MANAGING SELINUX PORT LABELING
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    SUMMARY
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab" class="md-nav__link">
    LAB
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  




  <h1>Managing Network Security</h1>

<h3 id="managing-server-firewalls">MANAGING SERVER FIREWALLS<a class="headerlink" href="#managing-server-firewalls" title="Permanent link">&para;</a></h3>
<h4 id="firewall-architecture-concepts">FIREWALL ARCHITECTURE CONCEPTS<a class="headerlink" href="#firewall-architecture-concepts" title="Permanent link">&para;</a></h4>
<p>The Linux kernel includes netfilter, a framework for network traffic operations such as packet
filtering, network address translation and port translation. By implementing handlers in the kernel
that intercept function calls and messages, netfilter allows other kernel modules to interface
directly with the kernel's networking stack. Firewall software uses these hooks to register filter
rules and packet-modifying functions, allowing every packet going through the network stack to
be processed. Any incoming, outgoing, or forwarded network packet can be inspected, modified,
dropped, or routed programmatically before reaching user space components or applications.
Netfilter is the primary component in Red Hat Enterprise Linux 8 firewalls.</p>
<p><strong>Nftables enhances netfilter</strong></p>
<p>The Linux kernel also includes nftables, a new filter and packet classification subsystem that
has enhanced portions of netfilter's code, but retaining the netfilter architecture such
as networking stack hooks, connection tracking system, and the logging facility. The advantages
of the nftables update is faster packet processing, faster ruleset updates, and simultaneous
IPv4 and IPv6 processing from the same rules. Another major difference between nftables
and the original netfilter are their interfaces. Netfilter is configured through multiple
utility frameworks, including iptables, ip6tables, arptables, and ebtables, which are now
deprecated. Nftables uses the single <strong>nft</strong> user-space utility, allowing all protocol management to
occur through a single interface, eliminating historical contention caused by diverse front ends and
multiple netfilter interfaces.</p>
<p><strong>Introducing firewalld</strong></p>
<p>Firewalld is a dynamic firewall manager, a front end to the nftables framework using the
<strong>nft</strong> command. Until the introduction of nftables, firewalld used the <strong>iptables</strong> command
to configure netfilter directly, as an improved alternative to the iptables service. In
RHEL 8, firewalld remains the recommended front end, managing firewall rulesets using <strong>nft</strong>.
Firewalld remains capable of reading and managing iptables configuration files and rulesets,
using xtables-nft-multi to translate iptables objects directly into nftables rules and
objects. Although strongly discouraged, firewalld can be configured to revert to the iptables
back-end for complex use cases where existing iptables rulesets cannot be properly processed
by <strong>nft</strong> translations.</p>
<p>Applications query the subsystem using the D-Bus interface. The firewalld subsystem,
available from the firewalld RPM package, is not included in a minimal install, but is included in a
base installation. With firewalld, firewall management is simplified by classifying all network
traffic into zones. Based on criteria such as the source IP address of a packet or the incoming
network interface, traffic is diverted into the firewall rules for the appropriate zone. Each zone has
its own list of ports and services that are either open or closed.</p>
<div class="admonition info">
<p class="admonition-title">NOTE</p>
<p>For laptops or other machines that regularly change networks, <strong><em>NetworkManager</em></strong>
can be used to automatically set the firewall zone for a connection. The zones are
customized with rules appropriate for particular connections.</p>
<p>This is especially useful when traveling between home, work, and public wireless
networks. A user might want their system's sshd service to be reachable when
connected to their home and corporate networks, but not when connected to the
public wireless network in the local coffee shop.</p>
</div>
<p>Firewalld checks the source address for every packet coming into the system. If that source
address is assigned to a specific zone, the rules for that zone apply. If the source address is not
assigned to a zone, <strong>firewalld</strong> associates the packet with the zone for the incoming network
interface and the rules for that zone apply. If the network interface is not associated with a zone
for some reason, then <strong>firewalld</strong> associates the packet with the default zone.</p>
<p>The default zone is not a separate zone, but is a designation for an existing zone. Initially,
<strong>firewalld</strong> designates the public zone as default, and maps the lo loopback interface to the
trusted zone.</p>
<p>Most zones allow traffic through the firewall, which matches a list of particular ports and protocols,
such as <strong>631/udp</strong>, or pre-defined services, such as ssh. If the traffic does not match a permitted
port and protocol or service, it is generally rejected. (The trusted zone, which permits all traffic
by default, is one exception to this.)</p>
<p><strong>Pre-defined Zones</strong></p>
<p>Firewalld has pre-defined zones, each of which you can customize. By default, all zones permit any
incoming traffic which is part of a communication initiated by the system, and all outgoing traffic.
The following table details these initial zone configuration.</p>
<p><strong>Default Configuration of Firewalld Zones</strong></p>
<table>
<thead>
<tr>
<th>ZONE NAME</th>
<th>DEFAULT CONFIGURATION</th>
</tr>
</thead>
<tbody>
<tr>
<td>trusted</td>
<td>Allow all incoming traffic.</td>
</tr>
<tr>
<td>home</td>
<td>Reject incoming traffic unless related to outgoing traffic or matching the ssh, mdns, ipp-client, samba-client, or dhcpv6-client pre-defined services.</td>
</tr>
<tr>
<td>internal</td>
<td>Reject incoming traffic unless related to outgoing traffic or matching the ssh, mdns, ipp-client, samba-client, or dhcpv6-client pre-defined services (same as the home zone to start with).</td>
</tr>
<tr>
<td>work</td>
<td>Reject incoming traffic unless related to outgoing traffic or matching the ssh, ipp-client, or dhcpv6-client pre-defined services.</td>
</tr>
<tr>
<td>public</td>
<td>Reject incoming traffic unless related to outgoing traffic or matching the ssh or dhcpv6-client  pre-defined services. The default zone for newly added network interfaces.</td>
</tr>
<tr>
<td>external</td>
<td>Reject incoming traffic unless related to outgoing traffic or matching the ssh pre-defined service. Outgoing IPv4 traffic forwarded through this zone is masqueraded to look like it originated from the IPv4 address of the outgoing network interface.</td>
</tr>
<tr>
<td>dmz</td>
<td>Reject incoming traffic unless related to outgoing traffic or matching the ssh pre-defined service.</td>
</tr>
<tr>
<td>block</td>
<td>Reject all incoming traffic unless related to outgoing traffic.</td>
</tr>
<tr>
<td>drop</td>
<td>Drop all incoming traffic unless related to outgoing traffic (do not even respond with ICMP errors).</td>
</tr>
</tbody>
</table>
<p>For a list of available pre-defined zones and intended use, see <strong>firewalld.zones</strong>(5).</p>
<p><strong>Pre-defined Services</strong></p>
<p>Firewalld has a number of pre-defined services. These service definitions help you identify
particular network services to configure. Instead of having to research relevant ports for the
samba-client service, for example, specify the pre-built samba-client service to configure
the correct ports and protocols. The following table lists the pre-defined services used in the initial
firewall zones configuration.</p>
<p><strong>Selected Pre-defined Firewalld Services</strong></p>
<table>
<thead>
<tr>
<th>SERVICE NAME</th>
<th>CONFIGURATION</th>
</tr>
</thead>
<tbody>
<tr>
<td>ssh</td>
<td>Local SSH server. Traffic to 22/tcp</td>
</tr>
<tr>
<td>dhcpv6-client</td>
<td>Local DHCPv6 client. Traffic to 546/udp on the fe80::/64 IPv6 network</td>
</tr>
<tr>
<td>ipp-client</td>
<td>Local IPP printing. Traffic to 631/udp.</td>
</tr>
<tr>
<td>samba-client</td>
<td>Local Windows file and print sharing client. Traffic to 137/udp and 138/udp.</td>
</tr>
<tr>
<td>mdns</td>
<td>Multicast DNS (mDNS) local-link name resolution. Traffic to 5353/udp to the 224.0.0.251 (IPv4) or ff02::fb (IPv6) multicast addresses.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">NOTE</p>
<p>Many pre-defined services are included in the firewalld package. Use <strong>firewall-
cmd --get-services</strong> to list them. Configuration files for pre-defined services
are found in <strong>/usr/lib/firewalld/services</strong>, in a format defined by
<strong>firewalld.zone</strong>(5).</p>
<p>Either use the pre-defined services or directly specify the port and protocol
required. The Web Console graphical interface is used to review pre-defined
services and to define additional services.</p>
</div>
<h4 id="configuring-the-firewall">CONFIGURING THE FIREWALL<a class="headerlink" href="#configuring-the-firewall" title="Permanent link">&para;</a></h4>
<p>System administrators interact with firewalld in three ways:</p>
<ul>
<li>
<p>Directly edit configuration files in <strong>/etc/firewalld/</strong> (not discussed in this chapter)</p>
</li>
<li>
<p>The Web Console graphical interface</p>
</li>
<li>
<p>The <strong>firewall-cmd</strong> command-line tool</p>
</li>
</ul>
<p><strong>Configuring Firewall Services Using the Web Console</strong></p>
<p>To configure firewall services with Web Console, log in with privileged access by clicking the <strong>Reuse
my password for privileged tasks</strong> option. This permits the user to execute commands with sudo
privileges to modify firewall services.</p>
<p>Click the <strong>Networking</strong> option in the left navigation menu to display the <strong>Firewall</strong> section in the main
networking page. Click the <strong>Firewall</strong> link to access the allowed services list.</p>
<p>The allowed services listed are those that are currently permitted by the firewall. Click the
arrow (&gt;) to the left of the service name to view service details. To add a service, click the <strong>Add
Services...</strong> button in the upper right corner of the <strong>Firewall Allowed Services</strong> page.</p>
<p>The <strong>Add Services</strong> page displays the available pre-defined services.</p>
<p>To select a service, scroll through the list or enter a selection in the <strong>Filter Services</strong> text box. In the
following example, the string <strong>http</strong> is entered into the search text box to find services containing
that string; that is, web related services. Select the check box to the left of the services to allow
through the firewall. Click the <strong>Add Services</strong> button to complete the process.</p>
<p>The interface returns to the <strong>Firewall Allowed Services</strong> page, where you can review the updated
allowed services list.</p>
<p><strong>Configuring the Firewall from the Command Line</strong></p>
<p>The <strong>firewall-cmd</strong> command interacts with the <strong>firewalld</strong> dynamic firewall manager. It is
installed as part of the main firewalld package and is available for administrators who prefer
to work on the command line, for working on systems without a graphical environment, or for
scripting a firewall setup.</p>
<p>The following table lists a number of frequently used <strong>firewall-cmd</strong> commands, along with
an explanation. Note that unless otherwise specified, almost all commands will work on the
runtime configuration, unless the <strong>--permanent</strong> option is specified. If the <strong>--permanent</strong> option
is specified, you must activate the setting by also running the <strong>firewall-cmd --reload</strong>
command, which reads the current permanent configuration and applies it as the new runtime
configuration. Many of the commands listed take the <strong>--zone=ZONE</strong> option to determine which
zone they affect. Where a netmask is required, use CIDR notation, such as 192.168.1/24.</p>
<table>
<thead>
<tr>
<th>FIREWALL-CMD COMMANDS</th>
<th>EXPLANATION</th>
</tr>
</thead>
<tbody>
<tr>
<td>--get-default-zone</td>
<td>Query the current default zone.</td>
</tr>
<tr>
<td>--set-default-zone=ZONE</td>
<td>Set the default zone. This changes both the runtime and the permanent configuration.</td>
</tr>
<tr>
<td>--get-zones</td>
<td>List all available zones</td>
</tr>
<tr>
<td>--get-active-zones</td>
<td>List all zones currently in use (have an interface or source tied to them), along with their interface and source information.</td>
</tr>
<tr>
<td>--add-source=CIDR [--zone=ZONE]</td>
<td>Route all traffic coming from the IP address or network/netmask to the specified zone. If no --zone= option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--remove-source=CIDR [--zone=ZONE]</td>
<td>Remove the rule routing all traffic from the zone coming from the IP address or network/netmask network. If no --zone= option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--add-interface=INTERFACE [--zone=ZONE]</td>
<td>Route all traffic coming from INTERFACE to the specified zone. If no --zone= option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--change-interface=INTERFACE [--zone=ZONE]</td>
<td>Associate the interface with ZONE instead of its current zone. If no --zone= option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--list-all [--zone=ZONE]</td>
<td>List all configured interfaces, sources, services, and ports for ZONE. If no --zone=option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--list-all-zones</td>
<td>Retrieve all information for all zones (interfaces, sources, ports, services).</td>
</tr>
<tr>
<td>--add-service=SERVICE [--zone=ZONE]</td>
<td>Allow traffic to SERVICE. If no --zone=option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--add-port=PORT/PROTOCOL [--zone=ZONE]</td>
<td>Allow traffic to the PORT/PROTOCOL port(s). If no --zone= option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--remove-service=SERVICE [--zone=ZONE]</td>
<td>Remove SERVICE from the allowed list for the zone. If no --zone= option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--remove-port=PORT/PROTOCOL [--zone=ZONE]</td>
<td>Remove the PORT/PROTOCOL port(s) from the allowed list for the zone. If no --zone=option is provided, the default zone is used.</td>
</tr>
<tr>
<td>--reload</td>
<td>Drop the runtime configuration and apply the persistent configuration.</td>
</tr>
</tbody>
</table>
<p>The example commands below set the default zone to dmz, assign all traffic coming from the
192.168.0.0/24 network to the internal zone, and open the network ports for the mysql
service on the internal zone.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>[root@host ~]# firewall-cmd --set-default-zone=dmz
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>[root@host ~]# firewall-cmd --permanent --zone=internal \
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>--add-source=192.168.0.0/24
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>[root@host ~]# firewall-cmd --permanent --zone=internal --add-service=mysql
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>[root@host ~]# firewall-cmd --reload
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">NOTE</p>
<p>For situations where the basic syntax of <strong>firewalld</strong> is not enough, you can also add
rich-rules, a more expressive syntax, to write complex rules. If even the rich-rules
syntax is not enough, you can also use Direct Configuration rules, raw <strong>nft</strong> syntax
mixed in with <strong>firewalld</strong> rules.</p>
<p>These advanced modes are beyond the scope of this chapter.</p>
</div>
<h3 id="controlling-selinux-port-labeling">CONTROLLING SELINUX PORT LABELING<a class="headerlink" href="#controlling-selinux-port-labeling" title="Permanent link">&para;</a></h3>
<h4 id="selinux-port-labeling">SELINUX PORT LABELING<a class="headerlink" href="#selinux-port-labeling" title="Permanent link">&para;</a></h4>
<p>SELinux does more than just file and process labeling. Network traffic is also tightly enforced
by the SELinux policy. One of the methods that SELinux uses for controlling network traffic
is labeling network ports; for example, in the <strong>targeted</strong> policy, port <strong>22/TCP</strong> has the label
<strong>ssh_port_t</strong> associated with it. The default HTTP ports, <strong>80/TCP</strong> and <strong>443/TCP</strong>, have the label
<strong>http_port_t</strong> associated with them.</p>
<p>Whenever a process wants to listen on a port, SELinux checks to see whether the label associated
with that process (the domain) is allowed to bind that port label. This can stop a rogue service
from taking over ports otherwise used by other (legitimate) network services.</p>
<h4 id="managing-selinux-port-labeling">MANAGING SELINUX PORT LABELING<a class="headerlink" href="#managing-selinux-port-labeling" title="Permanent link">&para;</a></h4>
<p>If you decide to run a service on a nonstandard port, SELinux almost certainly will block the traffic.
In this case, you must update SELinux port labels. In some cases, the <strong>targeted</strong> policy has already
labeled the port with a type that can be used; for example, since port <strong>8008/TCP</strong> is often used for
web applications, that port is already labeled with <strong>http_port_t</strong>, the default port type for the
web server.</p>
<p><strong>Listing Port Labels</strong></p>
<p>To get an overview of all the current port label assignments, run the <strong>semanage port -l</strong> command. The <strong>-l</strong> option lists all current assignments in this form:</p>
<p><code>port_label_t     tcp|udp     comma,separated,list,of,ports</code></p>
<p>Example output:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>[root@host ~]# semanage port -l
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>...output omitted...
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>http_cache_port_t        tcp       8080, 8118, 8123, 10001-10010
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>http_cache_port_t        udp       3130
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>http_port_t              tcp       80, 81, 443, 488, 8008, 8009, 8443, 9000
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>...output omitted...
</code></pre></div>
To refine the search, use the <strong>grep</strong> command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>[root@host ~]# semanage port -l | grep ftp
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>ftp_data_port_t        tcp       20
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>ftp_port_t             tcp       21, 989, 990
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>ftp_port_t             udp       989, 990
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>tftp_port_t            udp       69
</code></pre></div>
<p>Note that a port label can appear twice in the output, once for TCP and once for UDP.</p>
<p><strong>Managing Port Labels</strong></p>
<p>Use the <strong>semanage</strong> command to assign new port labels, remove port labels, or modify existing
ones.</p>
<div class="admonition danger">
<p class="admonition-title">IMPORTANT</p>
<p>Most standard services available in the Linux distribution provide an SELinux policy
module that sets labels on ports. You cannot change the labels on those ports using
<strong>semanage</strong>; to change those, you need to replace the policy module. Writing and
generating policy modules falls outside the scope of this course.</p>
</div>
<p>To add a port to an existing port label (type), use the following syntax. The <strong>-a</strong> adds a new port
label, the <strong>-t</strong> denotes the type, the <strong>-p</strong> denotes the protocol.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>[root@host ~]# semanage port -a -t port_label -p tcp|udp PORTNUMBER
</code></pre></div>
For example, to allow a gopher service to listen on port <strong>71/TCP</strong>:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[root@host~]# semanage port -a -t gopher_port_t -p tcp 71
</code></pre></div>
To view local changes to the default policy, administrators can add the <strong>-C</strong> option to the <strong>semanage</strong>
command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>[root@host~]# semanage port -l -C
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>SELinux Port Type        Proto       Port Number
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>gopher_port_t            tcp           71
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">NOTE</p>
<p>The <strong>targeted</strong> policy ships with a large number of port types.</p>
<p>Service specific SELinux man pages found in the selinux-policy-doc package include
documentation on SELinux types, booleans, and port types. If these man pages are
not yet installed on your system, follow this procedure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>[root@host ~]# yum -y install selinux-policy-doc
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>[root@host ~]# man -k _selinux
</code></pre></div>
</div>
<p><strong>Removing Port Labels</strong></p>
<p>The syntax for removing a custom port label is the same as the syntax for adding a port label, but
instead of using the <strong>-a</strong> option (for Add), use the <strong>-d</strong> option (for Delete).</p>
<p>For example, to remove the binding of port <strong>71/TCP</strong> to <strong>gopher_port_t</strong>:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>[root@host ~]# semanage port -d -t gopher_port_t -p tcp 71
</code></pre></div>
<strong>Modifying Port Bindings</strong></p>
<p>To change a port binding, perhaps because requirements changed, use the <strong>-m</strong> (Modify) option.
This is a more efficient process than removing the old binding and adding a new one.</p>
<p>For example, to modify port <strong>71/TCP</strong> from <strong>gopher_port_t to http_port_t</strong>, an administrator
can use the following command:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>[root@server ~]# semanage port -m -t http_port_t -p tcp 71
</code></pre></div>
As before, view the modification using the <strong>semanage</strong> command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>[root@server ~]# semanage port -l -C
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>SELinux Port Type          Proto        Port Number
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>http_port_t                 tcp          71
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>[root@server ~]# semanage port -l | grep http
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>http_cache_port_t          tcp                 8080, 8118, 8123, 10001-10010
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>http_cache_port_t          udp                 3130
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>http_port_t                tcp                 71, 80, 81, 443, 488, 8008, 8009, 8443,
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>9000
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>pegasus_http_port_t        tcp                 5988
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>pegasus_https_port_t       tcp                 5989
</code></pre></div>
<h3 id="summary">SUMMARY<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h3>
<p>In this chapter, you learned:</p>
<ul>
<li>
<p>The netfilter subsystem allows kernel modules to inspect every packet traversing the
system. All incoming, outgoing or forwarded network packets are inspected.</p>
</li>
<li>
<p>The use of <strong>firewalld</strong> has simplified management by classifying all network traffic into zones.
Each zone has its own list of ports and services. The <strong>public</strong> zone is set as the default zone.</p>
</li>
<li>
<p>The firewalld service ships with a number of pre-defined services. They can be listed using
the <strong>firewall-cmd --get-services</strong> command.</p>
</li>
<li>
<p>Network traffic is tightly controlled by the SELinux policy. Network ports are labeled. For
example, port <strong>22/TCP</strong> has the label <strong>ssh_port_t</strong> associated with it. When a process wants to listen on a port, SELinux checks to see whether the label associated with it is allowed to bind that port label.</p>
</li>
<li>
<p>The <strong>semanage</strong> command is used to add, delete, and modify labels.</p>
</li>
</ul>
<h3 id="lab">LAB<a class="headerlink" href="#lab" title="Permanent link">&para;</a></h3>
<p>pdf - 336</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 8, 2022</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../boot/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Controlling The Boot Process" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Controlling The Boot Process
            </div>
          </div>
        </a>
      
      
        
        <a href="../instalrhel/" class="md-footer__link md-footer__link--next" aria-label="Next: Installing Red Hat Enterprise Linux" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Installing Red Hat Enterprise Linux
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Divijesh Varma. All rights reserved.
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.top", "navigation.sections", "content.tooltips", "header.autohide"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/feedback.js"></script>
      
    
    
  </body>
</html>